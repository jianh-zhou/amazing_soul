# 20 js高级第三天

## 执行上下文

### 在执行某段代码时.都会进行一个准备工作,这个准备工作用专业术语就叫执行上下文.其实执行上下文也就是在栈中开辟一个空间

### 在函数调用时会创建一个函数执行上下文.在进入script标签时,会创建一个全局执行上下文

### 对于多个执行上下文.系统会开辟执行上下文栈,用来保存当前的执行上下文

### 函数的执行上下文在调用并且执行完毕后,会进行销毁,全局执行上下文只有在网页关闭后才会销毁

### 属性

- 变量对象
- this指向
- 作用域链

## 变量对象

### 定义: 执行上下文相关的数据作用域,保存上下文中定义的变量和函数声明

### 变量提升就是变量对象的一种实现

### 提升顺序

- 在全局执行上下文中

	- 函数>变量

- 局部执行上下文中

	- 实参(areguments)>形参>函数>变量

### 变量提升覆盖规则

- 在变量提升时,如果遇到同一个变量名时,是不会进行覆盖的,只有在赋值时,才会覆盖之前相同变量名所代表值

### 全局的变量对象是window

## 作用域链

### 在函数定义时,会有一个[[scope]]属性.里面保存的是定义函数时的祖先级的作用域关系,当函数调用执行时,函数自身会生成自己的执行环境,这时将自身的作用域与[[scope]]属性进行相连,最后得到一条作用域链

### 起点是当前自身执行环境的变量对象

### 终点是全局变量对象,也就是window

### 作用

- 寻找变量的一系列过程,如果找到了.就不会再继续往上找了
- 专业术语

	- 是保证对执行环境有权访问的所有变量和函数的有序访问

## 作用域

### 函数定义时他的外部作用域就已经固定,与执行时的环境没有关系,

### 执行上下文与作用域没有根本的关系

### 在不同的作用域中的变量不会冲突

## 作用域与执行上下文的区别

### 区别1

- 函数作用域是在函数定义时就有的
- 全局执行上下文是全局作用域确定,代码执行之前就创建
- 函数执行上下文是在调用函数之后,执行代码之前创建

### 区别2

- 作用域是固定的.不会变的,而执行上下文如果函数调用完时,都会销毁

### 联系

- 执行上下文是从属于作用域的

## 闭包

### 形成条件

- 有嵌套的函数关系
- 里面的函数有用到外面函数的变量
- 外层函数必须调用

### 闭包的定义

- 理解1

	- 嵌套的内部函数

- 理解2

	- 包含被调用变量的对象

### 闭包的作用

- 当一个函数内部变量,在函数调用完毕后变量仍然可以存活.也就是可以延长变量的生命周期
- 可以使用函数内部的变量

### 常见闭包出现情况

- 让一个函数作为返回值时
- 将参数传递给里面的函数使用时

### 优点

- 隔绝变量

### 缺点

- 内存泄漏

	- 在使用时,需要及时释放

### 生命周期

- 产生

	- 在函数定义(创建变量对象)时,不是在函数调用时

- 死亡

	- 在嵌套函数成为垃圾对象时

### 应用

- 定义js模块

	- 具有特定功能的js文件
	- 模块的使用者,可以通过访问函数名来访问模块里的方法和对象
	- 将多个方法或者数据封装到一个函数中
	- 只向外暴露一个包含n个对象和方法的函数

## 进程

### JavaScript就是单线程

### 程序的一次执行,它占有一片独立的内存空间

## 线程

### 进程内的一个独立单元,CPU的基本调度单位,是程序运行的一个完整流程

## 进程与线程

### 一个进程可能只有一个线程,该线程称为主线程

### 一个进程之间的多个线程,线程所有的数据可以共享当前进程中的数据

### 进程之间的数据时不能进行共享的

### 一个进程中有多个线程时,我们称为多线程运行

## 单线程与多线程的区别

### 单线程

- 优点

	- 编程顺序比较简单易懂

- 缺点

	- 效率较低

### 多线程

- 优点

	- 提升cpu的利用率

- 缺点

	- 创建多线程开销
	- 线程间切换开销
	- 线程死锁与同步问题

## 浏览器的线程

### 单线程

- 老版IE
- Firefox  火狐

### 多线程

- 新版IE
- 谷歌

