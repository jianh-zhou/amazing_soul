# 10 react 项目第一天

## 1 手机号码验证组件的基础搭建

### 1 创建对应的文件及文件夹,来搭建注册账号时手机号码的一些验证操作,并且将该verifyPhone组件设置为路由组件

### 2 在对应的routes文件中引入这个组件,将其放入到routes数组中,然后在App组件中进行遍历展示

### 3 根据antd-mobile组件库搭建结构

- 导航栏部分

	- NabBar 组件

- 手机号码输入框部分

	- InputItem 组件

- 按钮部分

	- Button 组件

- 注册须知协议部分

	- Model 组件

## 2 手机号码验证

### 1 下载re-form插件并且引入该包中的createFore高阶组件,该高阶组件会进行两次调用,第一次不传递任何参数,第二个传递当前组件为对应参数

- npm i 're-form'

### 2 高阶组件的作用是,会将form对象绑定在props属性上,

### 3 给InputItem手机号码输入框组件使用form对象上的方法,方法中传递参数,最终将该方法的返回值,作为InputItem组件的属性

- { ...getFieldProps('phone',{rules:[{validator:this.vaildator}]})}
- getFiledProps第一个参数是对应检验的表单的名字,第二个是一个对象,对象中的rules属性,是应校验规则的一个回调函数

### 4 定义输入框的校验规则的回调函数,该回调函数有3个属性,

- 属性

	- 1 rules

		- 对应的校验的名字('phone')

	- 2 value

		- 表单的内容

	- 3 callback

		- 不管校验成功还是失败表单都会执行的一个回调函数

- 1 书写对应的正则表单式,用来校验输入的手机号
- 2 这里因为表单验证只需要让对应按钮可以使用就行,而我们的按钮大多数都是应该处于禁用状态,我们设置一个变量,让其设置为ture,如果输入框的内容符合正则,我们就让其改变为false,不管这个值是什么,我们都应该调用对应的this.setState方法,修改状态数据,实现页面的对应按钮状态发生变化

## 3 封装对应的滑动块验证的全局组件

### 1 创建对应的文件,并且引入对应的包,和对应的按钮,该组件至少接收两个参数,一个是对应按钮的的显示文字,一是两个按钮的切换切换状态的状态数据

### 2 根据对应腾讯云对应的文档,书写代码

- 腾讯云web端接入文档：https://cloud.tencent.com/document/product/1110/36841#.E5.AE.9E.E4.BE.8B.E6.96.B9.E6.B3.95

### 3 该按钮组件需要替换为对应的antd-mobile UI库的Button组件,但是如果直接使用,这个组件的禁用效果失效,我们需要设置两个样式一样的按钮,

- 一个按钮用来在按钮不可以点击时使用,也就是按钮为禁用状态时
-  一个按钮用来在按钮可以点击时,这个按钮点击就会出现弹出对应的滑块框,进行验证

### 4 对应的滑块框有一个对应的回调函数,这个回调函数我们需要绑定在window上,并且在componentDidMount组件挂载完毕的生命周期回调函数中,进行绑定

### 5 书写对应的api接口函数,该接口函数,用来验证对应滑块的在服务器那边的状态,该api函数接收两个参数,一个是res.randstr, 另外一个是res.ticket(res是对应滑块的回调函数,传递过来的参数)

### 6 在滑块对应的回调函数中,进行异步请求,因为会使用async,await,我们需要将请求的代码包裹一层try..catch,如果滑块验证失败,弹出对应的提示消息

## 4 添加对应手机号码验证的方法

### 1 定义对应的api接口函数,该函数接一个手机号码作为参数传递过去

### 2 通过this.props.form.getFiledProps('phone').value获取对应的输入的手机号码

### 3 在执行异步请求代码时,使用async 和await,

### 4 将这个函数,传入到对应的滑块验证的全局组件,因为在验证完滑块是否成功后,需要验证手机号是否被注册过,所以我们需要将这个函数传递给这个全局组件

## 5 设置响应拦截器

### 请求成功

- 功能完成成功

	- 真正意义上的请求成功,状态吗为对应的成功状态码

- 功能完成失败

	- 虽然响应是成功的,但是并没有完成功能,它只是服务器响应成功,比如注册手机号时,手机号重复这种情况,虽然进入成功的回调,但是它并没有完成手机号的注册

### 请求失败

- 服务器有返回对应响应

	- 服务器有做出对应响应,但是是失败的
	- 1 401 没有对应权限.比如进行操作时没有登录
	- 2 403 禁止访问
	- 3 404 没有找到相关资源,或者请求地址出错

- 服务器没有返回响应

	- 服务器直接没有做出响应
	- 1 请求超时
	- 2 网络连接有问题

### 我们在操作时,需要根据错误的不同,给不同的响应消息,所以我们需要分析各种请求的状态

