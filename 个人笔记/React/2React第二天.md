# React 第二天

## refs

### 使用refs属性,可以拿到对应的元素对象,和组件标签对象

### 三种定义的方法

- 1 stringRef

	- 和vue类似,直接在对应的标签中添加一个ref属性,值为一个字符串,然后直接通过this.refs.stringRef访问

		- 设置

			- ref='stringRef'

		- 访问

			- this.refs.stringRef

	- 已经弃用,了解

- 2 回调函数func

	- 在标签中,添加一个ref属性.值为一个表达式,表达式内部是一个箭头函数,箭头函数的参数是就是氮气标签对象,通过将该参数,赋值给组件实例对象上的一个属性,最后通过this访问对应的标签对象

		- 设置

			- ref={ (input)=>this.funcRef=input}

		- 访问

			- this.funcRef

- 3  使用一个方法,将其挂载到一个实例对象上

	- 在标签中,添加一个ref属性,属性值是一个实例上的属性

		- 设置

			- 1 ref={this.createRef} 
			- 2 给实例添加一个属性, 

				- createRef=React.createRef() 
				- 每次调用这个方法,返回一个不一样的对象,最终对应的标签对象绑定在这个对象的current属性上

		- 访问

			- this.createRef.current

	- 最常用

### 原理就是将对应的标签对象绑定在实例上或者绑定在实例上的对象属性上

## props

### 实现父子组件之间通信,传递函数时,可以实现子级组件向父组件传递数据,传递函数时,可以实现父组件向子组件通信

### 1 直接给子组件标签添加一个属性,属性值是一个js表达式

### 2 子组件直接就可以通过this.props直接使用,但是一般我们需要进行验证,使用一个prop-types库

- 1 引入对应的插件库

	- import PropTypes from 'prop-types'

- 2 直接在接收的对应组件中定义一个属性propTypes属性,属性值是一个对象,对象中的每一个属性就是要验证接收的prop因为是属性,所以首字母是小写,
- 3 例子

	-   static propTypes = {
    name: PropTypes.string.isRequired, // 必选属性
    age: PropTypes.number.isRequired,
    sex: PropTypes.string, // 可选属性
  };


- 4 给属性设置默认值

	- static defaultProps={sex:'女'}
	- 如果父组件没有传递这个属性的话,就使用这个默认属性,否则就是传递过来的对应属性

- 必须使用static.因为这样才能给类添加属性,直接写的话,是给实例上直接添加属性

## todoList 案例

### 1 拆分组件,搭建对应的结构和书写样式

- 1 App组件

	- 1 Header组件
	- 2 List组件

		- Item 组件

	- 3 Footer组件

### 2 设置对应的数据todos,将列表数据进行展示

- 1 在App组件中设置数据,将其传递给List组件,进行展示,然后将对应的每一项传递给Item组件
- 2 在App组件中计算好所有任务的数量total,和已经完成的数量doneNum,然后传递给Footer组件

	- 计算时,使用数组的对应方法

### 3 添加任务

- 1 在App组件定义添加任务对应的方法addTodo,该方法中,通过调用对应的this.setState方法,为数组中添加一个对象,该对象的内容是Header子组件传递过来的
- 2 将该方法addTodo和todos传递给Header子组件,并且进行验证
- 3 给表单输入框添加一个回车事件,使用事件对象,

	- 1 判断输入的内容content是否为空
	- 2 判断输入的内容content是否有重复,使用数组的find方法
	- 3 调用父级传递过来的addTodo方法,并且将该文本框的内容content作为参数传递过去

### 4 鼠标移入移出当前行显示或者隐藏删除按钮

- 1 设置一个状态数据isShowBtn,用来实现删除按钮的显示与隐藏,并且在对应的删除按钮标签中,使用三元运算符,对齐进行操作
- 1 在Item组件中给对应的li标签绑定一个鼠标移入和移出事件,它们的回调函数都是同一个,只是需要传递不一样的参数,一个是true一个是false,
- 2 定义对应的鼠标移入移出的方法,该方法中,调用对应修改状态数据的方法,this,setState,将isShow修改为传递进来的数据

### 5 删除当前任务

- 1 App组件中定义一个删除任务的方法deleteTodo,该方法接受子组件传递过来的一个id

	- 该方法中调用this.setState方法,方法中调用数组的filter方法,将当前id的对应的任务删除

- 2 List组件接收这个方法deleteTodo,并且进行验证,然后传递给Item组件
- 3 Item组件接收方法该方法,并且进行验证
- 4 给按钮绑定一个点击事件,将当前行的id作为参数进行传递,事件的回调函数中需要返回一个方法,该方法最终作为按钮的事件回调函,事件的回调函数中调用传递过来的deleteTodo方法,最终实现删除

### 6 勾选或者不勾选当前行的任务

- 1  在App组件中定义一个更新任务状态的方法update,并且传递给List组件,List组件验证后,传递给Item组件

	- 该方法接收Item组件传递过来的一个id,方法内部调用this.setState方法,使用数组的map方法,修改对应的数据

- 2 Item组件接收这个方法,并且进行验证
- 3 给对应的复选框绑定一个onChange事件,

	- 所有的文本框的事件都是onChange事件,是React的合成事件,并不是原生的事件
	- 将当前的id作为参数进行传递,该事件的回调函数中返回一个函数,函数内容调用App组件中的更新状态的方法

### 7 给全选的多选框绑定一个事件,该事件用来,全选任务和全不选任务

- 1 在App组件定义一个全选的方法checkedAll,将传递给Footer子组件,并且进行验证,

	- 该方法内部接收一个参数,该参数是Footer子组件多选框在点击后的checked的值,调用对应的this.setState方法,使用数组的map方方法,将所有任务的选中状态的值改变为传递过来的参数

- 2 Footer组件接收checkedAll方法,并且进行验证
- 3 设置多选框的checked的值,该值是一个三元运算符,

	- checked={total===doneNum?true:false}

- 4 为多选框绑定一个合成事件onChange

	- 该方法内部通过事件对象event.获取到当前多选框点击后的checked的值,然后调用App组件传递过来的checkedAll方法,将当前多选框的值作为参数传递过去

### 8 清除以完成任务

- 1 在App组件中定义一个方法,该方法内部,调用this.setState方法,然后调用数组的filter方法,将所有已完成的任务过滤掉
- 2传递给子级组件Footer,并且进行验证
- 3 给清除已完成任务添加一个点击事件,事件的回调函数中,调用对应的App组件传递过来的方法

## 总结

### 1 子级组件不能直接修改父级组件的数据,可以通过调用父级组件传递过来的方法,间接修改父级组件的数据

### 2 在修改状态数据时,需要调用对应的this.setState方法,并且不能直接修改其中的数据.应该得到一个变化后的值,再将之前的值覆盖

### 3 对事件进行传参时,它会直接调用该函数,所有函数内部需要返回一个函数(形成闭包),让返回的这一个函数,作为事件的回调函数

### 4. 直接在类中定义的方法(使用等号加箭头函数)是直接绑定在当前实例对象上的,并不是直接绑定在类的原型上  ,直接定义的属性也是这样,只有使用static关键字定义的是类本身的  ,如果使用普通函的定义方式则是定义在原型上

