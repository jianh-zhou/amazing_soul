# 2 微信小程序第二天

## 1 事件绑定

### 1 事件机制

- 1 网景公司的事件捕获机制(现在不存在了)
- 2 微软的事件冒泡机制
- 3 ECMA的标准事件机制

### 2 事件分类

- 1 冒泡事件和非冒泡事件

	- 冒泡事件

		- 绑定时间的关键字: bind+事件的类型="事件回调函数名称"

	- 非冒泡事件

		- 绑定事件的关键字 : catch+事件的类型="事件回调函数的名称"

- 3 捕获事件和非捕获事件

	- 捕获事件

		- 绑定事件的关键字是capture:bind+事件的类型="事件的回调函数名称"

	- 非捕获事件

		- 绑定事件的关键字是capture:catch+事件的类型="事件的回调函数名称"

### 事件的回调函数注册位置和react类似.与生命周期回调函数在同一级别

## 2 路由跳转

### wx.navigateTo()(类似于push方法)

- 1 使用这个方式进行跳转的组件不会被卸载,而是相当于被缓存起来了.保留当前页面的实例对象(和vue组件的keep-alive很相似)
- 2 用该api跳转页面,会触发当前页面的onHide生命周期回调函数
- 3 小程序的页面栈最多10层,最开始是5层.

### wx.redirectTo(类似于replace方法)

- 1 在跳转到其他页面时,会卸载掉当前组件页面
- 2 使用该Api跳转页面,会触发onUnload的生命周期回调函数

## 3 微信小程序的生命周期回调函数

### onLoad

- 页面开始加载

### onShow

- 页面开始显示

### onReady

- 页面首次渲染结束

### onHide

- 页面隐藏

### onUnload

- 页面卸载

## 4 用户首次登陆功能

### 1 我们在使用小程序时,都会进行首次登陆授权

### 2 使用button组件,绑定一个属性opent-ype和一个对应的事件bindgetuserinfo

- opent-ype="getUserInfo"
- bindgetuserinfo="getUserInfo"

### 3 定义对应的getUserInfo事件回调函数,该函数接收一个参数,该参数是根据用户点击确定或者取消接收的参数,如果是确定则这个数据中就会包括获取到的用户信息数据,如果失败就不会有用户的信息数据,根据获取到这个用户信息数据,将其设置为动态数据

### 4 使用条件渲染,根据动态数据是否存在,显示或者隐藏对应组件,显示获取用户信息头像就不显示获取用户信息的按钮

## 5 用户第二次登陆功能

### 1 在第一次授权过后,用户的信息数据已经获取到,但是第二次进行应用中,还需要自己点击对应的获取用户信息按钮,用户体验差

### 2 我们在onLoad生命周期回调函数中,调用对应的方法wx.getUserInfo(),该方法传入一个对象作为参数,对象中设置一个成功的success属性,这个属性的值是一个回调函数,只有用户有获取过用户信息数据才会,调用这个回调函数,这个回调函数的接收一个参数,该参数就是对应的用户信息数据,然后将对应的用户信息数据设置为动态数据,将其展示在页面中,不管用户有没有进行授权,都会执行这个方法,如果有则展示数据,没有也不会影响

### 2 我们在onLoad生命周期回调函数中,调用对应的方法wx.getUserInfo(),该方法传入一个对象作为参数,对象中设置一个成功的success属性,这个属性的值是一个回调函数,只有用户有获取过用户信息数据才会,调用这个回调函数,这个回调函数的接收一个参数,该参数就是对应的用户信息数据,然后将对应的用户信息数据设置为动态数据,将其展示在页面中,不管用户有没有进行授权,都会执行这个方法,如果有则展示数据,没有也不会影响

