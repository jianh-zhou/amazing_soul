
# 20 后台管理系统第二天



## 自定义事件和原生事件

### 原生事件

- 系统自带的一些事件
- 在普通标签中使用

  - 直接使用即可,使用 v-on(@)指令

- 在组件标签中使用

  - 需要加上一个 .native 修饰符,原生事件在组件标签中才是真正的原生事件,如果不加修饰符,它会被当做自定义事件,需要分发才能使用

### 自定义事件

- 自己定义的事件
- 在普通标签中使用自定义事件是没有任何效果的
- 在组件标签中使用

  - 1 除开原生事件类型加上 .native 修饰符以外,所有的事件都是自定义事件
  - 2 自定义事件需要在子组件中分发,该事件对应的回调函数(或者表达式)才会执行
  - 3 在组件标签中使用 v-on 指令的自定义事件时,就给子组件传递了数据
  - 4 当子组件在分发父组件传递过来的自定义事件时,可以传递参数给父组件
  - 5 传递参数的优先级,

    - 如果在定义自定义事件,就传递参数,那么子组件分发传递的参数就无效,最终都只会传递定义时传递的参数
    - 如果分发事件时,只有分发事件传递参数,那么这些参数再父级组件中就能正常使用

- 可以实现父子,子父之间进行通信

## v-model

### 原理

- 强制数据绑定,和表单的 Input 事件

### 在普通文本框标签中使用

- 直接定义,使用 v-model
- 手写实现 v-model

  - 1 在文本标签中添加一个动态的 value 属性
  - 2 使用 v-on 指令,绑定一个原生的 input 事件,利用一个表达式,改变对应的属性值,最终实现 v-model

    - @input="msg=\$event.target.value"

### 在组件标签中使用

- 相当于给子组件传递一个动态的:vlaue 属性,和一个 input 自定义事件
- 1 在子组件中使用 props 接收,父组件传递过来的 value 属性
- 2 在子组件中分发父级组件传递过来的自定义事件,并且给自定义事件传递一个参数,父级组件就可以使用子级组件传递过来的参数,并且该参数就是的值就会赋值给对应的 v-model 的属性值

### 在组件标签中不使用 v-model 指令实现其功能

- 1 在组件设置一个强制数据绑定的属性
- 2 设置一个自定义事件

  - 如果使用的表达式,在接收子组件传递过来的参数时,使用\$event 接收,使用其他接收不到 ,而事件参数对象在没有传递参数时,是事件参数对象,如果有传递参数时,就是对应的参数

- 3 在子组件中分发传递过去的自定义事件,并且传递参数回来父组件使用

## . sync 修饰符

##### 在给组件标签添加一个动态的属性,和一个自定义事件,可以实现,父子,子父之间的通信

- 1 子组件接收传递过去的动态属性,使用 props
- 2 子组件分发父组件传递过来的自定义事件,传递参数
- 3 父组件接收参数,最终改变父组件中的数据

##### 直接使用这种方法,会在使用时显得不明显,我们可以在绑定自定义事件时,后面添加对应的 :动态属性的属性名 ,同样,在分发时,也需要将这一个整体的名字一起写入才能分发

##### 使用 在对应的动态属性名后加 .sync 修饰符,使用该修饰符后,不在需要写自定义事件,但是在子组件分发该事件时,对应的事件名为 update:属性名,并且传递参数,最终实现改变父级组件数据的效果,实现父子,子父之间的通信

- 1 父组件中的对应的子组件标签 \<Child :money.sync="total" />
- 2 子组件中接收对应的数据

  - props: ['money'],

- 3 子组件分发对应的事件

  - <button @click="\$emit('update:money', money - 100)">花钱</button>

-4 在子组件分发后,父组件就可以传递过去的数据

## $attrs和$listeners

### 当我们在需要封装组件时,会根据组件的用处不同,会传入数量不定和属性和自定义事件,这样我们接收就会十分的困难.可以使用$attrs和$listeners

### \$attrs

- 子组件直接可以通过 this 访问,是一个对象,
- 包含父级组件中使用该子级组件标签时,传递过来的所有属性,但是不包括以下三种情况

  - 1 class
  - 2 style
  - 3 子级组件中使用 props 接收过的属性

- 可以直接在子级组件中使用这些属性,v-bind这个指令可以的属性值可以是一个对象,最终都会解析会多个动态属性

### \$listeners

- 子组件可以通过 this 直接访问到该属性.该属性是一个对象
- 该属性包含了所有传递过来的自定义事件,但不包括传递过来的原生事件而且带.native 修饰符的事件
- 在子级组件中直接使用 v-on,可以将这些传递过来的自定义事件绑定在对应的组件标签中,最终会一次绑定到对应的标签上,最终分发实现

## $children和$parent

### \$parent

- 在子组件中使用,可以获得该子组件的唯一父级组件,从而可以向父级组件传递相应的数据

### \$children

- 在父级组件中使用,可以获得所有的直接子组件,是一个数组,可以使用这个属性为子级组件传递相应的数据,或者进行对应的操作

### 在修改其他组件时,我们虽然可以直接修改,但我们一般不会这样做,我们会调用对应的方法,修改其他组件的数据,

### 组件标签上也可以使用 ref 属性,使用\$refs 属性可以访问到对应组件上的数据及方法 

## 作用域插槽

### 当我们需要父级组件使用子级组件的数据时,我们可以使用作用域插槽

### 1 在子级组件中使用 slot 标签,该标签可以添加多个动态属性

- slot 标签有 name 属性,就是对应的具名插槽
- slot 标签没有 name 属性,就是默认插槽,相当于自动添加了一个 name 属性,值为 default

### 2 在父级组件对应的子组件标签中,使用 template 标签包裹,该标签中使用 v-slot 指令,该指令后跟:name 属性值,指令的值为一个对象,名字可以任意,可以在 template 标签中,使用对应的传递过来的对象中的属性,在该标签中,可以操作对应的数据,最终在子组件中渲染

### 3 如果是默认插槽,可以使用缩写

- 1 不使用 template 标签,直接在组件标签中使用 v-slot 指令
- 2 可以省略 :default,直接使用 v-slot 指令 -->

