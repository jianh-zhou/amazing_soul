# 23 后台项目第四天

## 1 展示添加或者修改spu信息的页面

### 使用组件进行展示,不再一起使用,显得十分繁杂

### 传递一个显示的动态属性(isShowSpuForm),该属性用来显示和隐藏对应的修改和添加spu信息的组件,可以直接在组件的根标签中使用v-show进行显示隐藏

### 父组件定义一个事件,该事件用来改变isShowSpuForm的值,并且给通过$refs获取到子组件的方法,进行调用

### 子组件中定义对应的初始化页面数据的方法,和对应请求数据的方法

- 1 根据spuId获取对应的spu信息数据
- 2 获取所有品牌信息的数组信息数据
- 3 获取所有的销售属性的数组
- 4 根据spuId获取所有的spu图片数组

	- 在赋值后,给该图片数组的每一项添加一个url属性和ImgName属性,添加属性的目的是为了图片在展示时能够有预览效果

### 定义对应的动态数据,并且对spuInfo数据,进行初始化操作,添加一些基础属性,因为在添加时,需要设置初始化属性

### 在点击取消按钮时,回到展示spu信息数据的组件,要想实现该操作,需要修改父组件传递过来的isShowSpuForm数据,这样会报错,因为子组件渲染后,会渲染父组件,而父组件中会有该值的初始化定义,会发生冲突  我们可以在传送数据时,使用.sync修饰符,最终子组件中分发自定义事件,实现间接修改父组件数据的操作

## 2 搭建spu信息页面

### 1 全部放在el-form组件中

### 2 没一项用el-form-item表示

## 3 展示对应的数据

### 1 根据spuInfo展示对应的spuName和description

### 2 根据获取到的所有的品牌信息数据数组,将其遍历并且在页面进行展示,通过对el-option绑定一个动态的value值,在选中该项时会将这个value值,赋值给el-select的v-model的值,内部最终实现将该值展示

### 3 操作上传图片的相关的钩子,在图片进行删除和添加时,图片数组并没有真正的修改,我们需要将函数fileList的参数赋值给图片数组

### 4 销售属性下拉框数据

- 1 销售下拉框最终展示的数据是所有销售属性数组中除开当前spu信息数据对象的销售属性数组的数据
- 2 通过计算属性,对所有销售属性调用filter方法,进行过滤,在其回调函数内部,再次调用当前销售属性数组的some方法,最终将该当前属性数组没有的属性,以数组的形式进行返回
- 3 遍历展示对应数据,并且给el-select添加一个动态的placeholder属性,该属性值为一个模板字符串

	- :placeholder="`${
          unSelectedSaleAttrList.length > 0
            ? `还有${unSelectedSaleAttrList.length}个可以选择`
            : '没有啦'
        }`"

### 5 当前销售属性的展示(el-table)

- 1 将当前的销售属性数组赋值给动态的data属性,spuInfo.spuSaleAttrList
- 2 通过prop属性,将该数组中对象的属性对应的属性值进行展示
- 3 通过作用域插槽获取到当前行的对象,并且获得当前销售属性中的属性值数组,通过遍历进行展示
- 4 在通过点击添加销售属性值对象时,回调函数中,判断当前行(row)是否有edit(用来判断编辑模式还是查看模式)属性,如果有,则改变其值,否则动态为当前行(row)添加一个edit属性
- 5 删除当前行的销售属性对象

	- 回调函数调用时接收当前销售属性对象所在的下标index,回调函数内部通过,使用splice操作当前属性对象数组对齐进行删除

## .sync修饰符的用途

### 父组件给子组件传递数据,子组件需要修改父组件传递过来的数据.使用.sync修饰符,用来分发自定义事件.达到修改父组件传递过来的数据

## axios传参

### axios的get请求分为两种传参方式

- params

	- 直接在请求时进行拼接,使用斜杠(/)分开,

- query

	- 以params进行传参,这个params是参数的意思,最终在拼接时是以问号?开始,以键值对的形式
	- {params:{test:ll}}

### 拼接在url地址上的信息的请求比在请求体中携带的请求速度快一些

### post请求的参数数据比get数据量携带的多,他也可以在地址栏中进行拼接,但是没有必要

