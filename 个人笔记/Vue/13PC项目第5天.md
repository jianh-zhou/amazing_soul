# 13 PC项目第5天

## 开发通用组件的流程

### 1 构建静态的html和css

### 2 初始化一些数据( data的数据初始化)

### 3 接收调用该组件传入的数据,props

- 在接收时,可以给这个数据设置一个默认值,因为不保证会传递参数,这样设置就算不传递参数也不会报错
- 在接收参数时,以对象的形式,

	- type: Object

		- 规定参数类型

	- default:{ }

		- 设置默认参数

### 4 需要接收什么样的事件

- 该事件可能是针对当前组件使用,也可能是针对父级组件服务

### 5 制作组件

- 根据组件的要求,设计对应的功能

### 6 制作组件使用的文档

- 1 传递什么样的参数
- 2 传递什么样的事件
- 3 怎么使用

## 分页组件的制作流程以及在搜索组件使用

### 1 设计对应的结构,添加对应的样式

- 1 设置8个button按钮,写入对应内容

	- 1 上一页
	- 2  第一页
	- 3  ...
	- 4 连续展示页
	- 5 ...
	- 6 最后一页
	- 7 下一页
	- 8 总共的数据条数

- 2 给所有可能需要禁用的按钮 ,设置禁用的属性

	- disabled
	- 禁止操作

### 2 使用props接收参数

- 1 接收的参数以一种对象形式书写
- 2 参数对象的参数pageConfig

	- 1 type: Object
	- 2 设置默认参数

		- 1 直接使用对属性的形式

			-       default: {
        // 都属于专门的配置关于分页的数据
        total: 0, // 总条数
        pageNo: 1, // 默认的第一页
        pageSize: 3, // 每页显示的条数
        showPageNo: 5, // 连续的页码数
      },

		- 2 使用方法的形式,返回一个对象,官方推荐使用

### 3 初始化data数据

- 添加一个currentPage数据,该数据表示当前选中的页码
- 给其设置一个初始值,值为传入的参数对象的pageNo属性

	- currrentPage:this.pageConfig.pageNo

### 4 根据传入的参数计算对应的属性 computed

- 总共的页码数  totalPage

	- 1 解构赋值得到total和pageSize
	- 1 判断传入的数据, 数据的总条数total和pageSize每页显示的条数,是否符合都大于0,如果符合则执行后面的代码,否则直接return
	- 2 返回一个值,该值是总的数据条数除以每页显示的条数向上取整的值

		- 向上取整 Math.ceil( )

- 页码的开始位置和结束位置的集合  startEnd

	- 1 解构赋值得到对应的totalPage(总共的页数) ,currentPage(当前显示的页数 ),showPageNo(连续的页码数)

		-       const {
        currentPage,
        totalPage,
        pageConfig: { showPageNo },
      } = this

	- 2 定义初始的页码start和结束的页码end让初始值都为0
	- 3 限定开始页码

		- 1 根据当前所在页码计算初始页码

			- 当前选中页码currentPage减去 (连续页码数除以2的向下取整)

		- 2 判断开始页码是否小于1,如果小于1,让开始页码等于1

	- 4 限定结束页码

		- 1 计算结束页码

			- (1) 根据开始页码计算计算结束页码

				- 因为选中的页码currentPage可能是会负数,如果不加这个限制,我们要让开始页码的最小值大于等于1
				- 开始页码加上连续页码数减1

			- (2) 根据当前选中页码数计算结束页码

				- 当前选中页码数加上(连续页码数除以2的向下取整)

		- 2 判断结束页码是否大于总页码数

			- 如果大于最大页码,则让结束页码等于最大页码.因为连续页码数是固定的,结束页码变小,开始页码也要变小,因为连续页码数是固定的,让开始页码数为将赋值后的结束页码减去连续页码数字再减1,然后再进行限制开始页码是否小于1,让其再等于1

	- 5 返回一个对象,包含计算判定过后的start和end

### 5 定义一个方法,根据当前传入的参数,计算最终选中的页码( currentPage)

- 1 根据传入的参数,设置对应选中的页码数
- 2 分发父级组件传递过来的自定义事件,并且将参数传递过去

### 6 根据计算出属性设置对应的按钮显示与隐藏以及绑定点击事件

### 7 将该组件在main.js中注册为全局公共组件,并且在搜索组件中使用,为其传入对应的参数,和绑定自定义事件

### 8 将更新数据的方法,传入一个默认值参数,让其pageNo默认值为1,让其作为自定义事件的回调函数

### 9 在分页组件中监视传入进来的pageNo属性,这样只要pageNo发生变化,就会让其设置为默认值1

## 详情(Detail) 组件的使用及数据

###  1 注册详情组件为路由组件

- 1 设置路由地址
-  2注册该组件
- 3 添加一个name属性

### 2 使用声明式路由router-link 标签实现路由跳转,并且传入对应的参数

### 3 设置api接口函数

- 直接使用ajax的get方法,并且传入一个skuId参数,最后将这个api函数暴露出去

	- (skuId)=>ajax.get(`/item/skuId `)

### 4 将其调用接口函数的返回值添加到vuex中

- 1 创建一个detail.js文件,里面放入对应的state,actions,mutations,getters
- 2 在对应的module中进行引入

### 5 分发对应的action,

## 将数据展示在对应的详情页面

### 1 引入辅助函数mapGetters

### 2 使用计算属性,通过解构辅助函数,拿到对应的数据,

### 3 通过数据categoryView将导航栏信息展示在页面(插值语法)

### 4 通过数据skuInfo将其商品信息展示在页面(插值语法)

### 5 通过遍历插值语法操做将商品销售属性展示在页面

- 1 遍历对应的数据spuSaleAttrList(v-for)
- 2 使用强制数据绑定设对应的动态样式

	- :class="{active:spuVal.isChecked==='1'}"

- 3 定义一个方法,传入两个参数,第一个为当前属性的所有结果的数组,第二个参数是当前要点击的属性结果,遍历该数组让所有属性isChecked的值变为'0',在遍历完成后,将其当前的属性的isChecked值设为'1'
- 3 给属性绑定一个点击事件,

