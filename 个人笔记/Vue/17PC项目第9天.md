# 17 PC项目第9天

## 我的订单中心

### 1 将整体的解构进行拆分出两个子组件

- 我的订单组件 MyOrder
- 团购列表组件 GroupBuy
- 因为这两个路由是子路由,在注册为路由组件时,我们应该在centr组件的内部使用children组件进行注册,并且设置MyOrder组件为默认路由组件,
- 因为涉及到二级路由,所以我们要在对应的位置,设置路由视图,(router-view) ,这样跳转到二级路由的时候,对应的路由组件才会显示
- 设置MyOrder组件的重定向

	- {path:'/cneter' , redirect:'/center/myorder'}
	- path属性 :对应的要设置的访问的路由地址
	- redirect属性 : 设置的重定向,也就是会最终跳转到该路由地址

- 使用router-link-active 设置对应的样式,也就是当前的链接标签会设置这些样式

### 2 定义对应的api函数,用来请求当前的订单中心的数据,

### 3 添加一些响应数据

- pageNo:1

	- 默认显示的页码数为第一页

- limit:10 

	- 每一页显示的条数

- total:0 

	- 总数据条数

- order:[ ]

	- 存储当前页面的订单信息数据数组

### 3 定义一个方法,用来请求数据,并且修改对应的数据

- 1 接收一个参数pageNO,并且设置我默认值1,可以用来在分页的时候该函数作为事件分发,并且设置对应的pageNo的值

	- this.pageNo=pageNo

- 1 调用对应的api函数,返回一个请求的对象

	- api函数时通过,绑定在Vue构造函数上原型对象上进行访问的
	- api接口函数的参数

		- this.limit 
		- this.page

- 2 判断接口函数返回的状态(code===200)
- 3 如果等于200,则对获取到的数据进行解构,然后改变对应的data中的数据值

	- const { records, total } = result.data
	- this.total = total
	- his.orders = records

### 4 通过获取到的数据,将order数组中的数据展示

- 1 因为一次订单可能会有多次商品,而一次订单的收货人信息时固定的,我们需要只需要在一个订单中展示一个收货人信息就行

	- 设置对应的跨列属性,然后使用template标签,将所有的信息包裹起来,对这个template标签设置的包裹的内容进行限制,使用v-if,设置下标为0的展示.其他的不展示

		- <templata v-if='index===0'>收货人信息 < /template>

- 2 在页面展示一些信息的时候,可以根据对应动态属性的值,使用三元表达式展示对应的数据

	- {{ item.orderStatus === 'UNPAID' ? '未支付' : '已完成' }}
	- 判断对应的属性是否存在,根据情况,展示对应的结果,

## 当前商品的订单界面

### 1 定义对应的请求当前订单的详情数据的api接口函数

### 2 因为当前的地址选中最终会影响下面的地址的数据,所以我们可以把最终选中的数据,添加到data数据中,只要这个数据一改变,最终下面的地址数据也会发生改变

### 3 在设置对应的选中的样式时,我们可以通过监视包含所有地址信息的数组,通过find遍历寻找对应的数据是否被选中,如果有,则将最终找到是数据复制给最开始定义的动态数据

## 支付界面

### 1 在order中,添加对应的state和mutation

### 2 添加对应的action,请求api接口函数,分发对应的的mutation,最终返回更新payInfo数据

### 3 将pay支付组件进行路由注册,添加一个props属性,可以用来获取路由中传递过来的参数

- props:(route)=>({orderId:route.query.orderId})

### 4 接收注册组件时的props参数

- props:['orderld']

### 5 在mounted中分发支付信息的action,传递orderId参数

### 6 引入辅助函数,将其在添加到计算属性中

### 7 更新页面的数据

